/**
 * oojs.js
 * version 1.0.0
 * (C) 2017, Vikas Burman
 * MIT License 
 */
(function(){const def=(opts={})=>{let oojs={},noop=()=>{},noopAsync=(resolve,reject)=>{resolve()},isServer=!1,options={env:opts.env||(isServer?"server":"client"),global:!0,supressGlobals:"undefined"!=typeof opts.supressGlobals&&opts.supressGlobals,symbols:opts.symbols||[]};oojs.Class=((arg1,arg2,arg3,arg4)=>{let className=arg1,inherits=null,mixins=[],interfaces=[],factory=null;"function"==typeof arg3?(factory=arg3,Array.isArray(arg2)?mixins=arg2:inherits=arg2):"function"==typeof arg4?(inherits=arg2,mixins=arg3,factory=arg4):"function"==typeof arg2&&(factory=arg2);let onlyMixins=[];for(let mixin of mixins)switch(mixin._.type){case"mixin":onlyMixins.push(mixin);break;case"interface":interfaces.push(mixin)}mixins=onlyMixins;let Class=function(_flag,_static,...args){let Parent=Class._.inherits,_this={},_exposed_this={},singleInstance=null,bucket=[],meta={},props={},events=[],classArgs=[],isNeedProtected=!1,staticInterface=null,theFlag="__flag__",mixin_being_applied=null;if(singleInstance=Class._.singleInstance())return singleInstance;if(_flag&&_flag===theFlag?(staticInterface=_static,isNeedProtected=!0,classArgs=args):(staticInterface=Class._.static,"undefined"!=typeof _flag?(classArgs=classArgs.concat([_flag]),"undefined"!=typeof _static&&(classArgs=classArgs.concat([_static]),"undefined"!=typeof args&&(classArgs=classArgs.concat(args)))):classArgs=args),Parent&&(_this=new Parent(theFlag,staticInterface,...classArgs),Parent._.isSealed()||Parent._.isSingleton()))throw`${className} cannot inherit from a sealed/singleton class ${Parent._.name}.`;const guid=()=>{return"_xxxxxxxx_xxxx_4xxx_yxxx_xxxxxxxxxxxx".replace(/[xy]/g,c=>{var r=16*Math.random()|0,v="x"==c?r:3&r|8;return v.toString(16)})},isSingletonClass=()=>{return hasAttr("singleton",meta._constructor)},isAbstractClass=()=>{return hasAttr("abstract",meta._constructor)},isSpecialMember=member=>{return["constructor","dispose","_constructor","_dispose","_"].indexOf(member)!==-1},isOwnMember=member=>{return"undefined"!=typeof meta[member]},isDerivedMember=member=>{return!isOwnMember(member)&&_this._.instanceOf.findIndex(item=>{return!!item.meta[member]})!==-1},isSealedMember=member=>{return hasAttr("sealed",meta[member])},isPrivateMember=(member=>{return hasAttr("static",meta[member])},member=>{return hasAttr("private",meta[member])}),isHiddenMember=member=>{return hasAttr("hide",meta[member])},isProtectedMember=member=>{return hasAttrEx("protected",member)},isSerializableMember=member=>{return hasAttrEx("serialize",member)},isConditionalMemberOK=member=>{let isOK=!0,_meta=meta[member],condition="";if(_meta)for(let item of _meta)if("conditional"===item.name){switch(isOK=!1,condition=item.args&&item.args.length>0?item.args[0]:""){case"server":isOK="server"===options.env;break;case"client":isOK="client"===options.env||""===options.env;break;default:isOK=options.symbols.indexOf(condition)!==-1}break}return isOK},doCopy=member=>{Object.defineProperty(_exposed_this,member,Object.getOwnPropertyDescriptor(_this,member))},isArrowFunction=fn=>{return!fn.hasOwnProperty("prototype")},attr=(attrName,...args)=>{let Attr=null;"string"==typeof attrName?Attr=oojs.Container.get(attrName)[0]:(Attr=attrName,attrName=Attr._.name),bucket.push({name:attrName,Attr:Attr,args:args})},getAttrArgs=(attrName,member)=>{let attrArgs=null;for(let item of _this._.instanceOf)if(item.meta[member]){for(let attrItem of item.meta[member])if(attrItem.name===attrName){attrArgs=attrItem.args;break}if(attrArgs)break}return null!==attrArgs?attrArgs:[]},applyAttr=targetName=>{let Attr=null,targetType=meta[targetName].type,attrArgs=null,attrInstance=null,decorator=null;for(let info of meta[targetName])if(Attr=info.Attr,Attr&&(attrArgs=info.args||[],attrInstance=new Attr(...attrArgs),decorator=attrInstance.decorator(),"function"==typeof decorator)){let descriptor=Object.getOwnPropertyDescriptor(_this,targetName);decorator(_this,targetType,targetName,descriptor),Object.defineProperty(_this,targetName,descriptor)}},hasAttr=(attrName,_meta)=>{let has=!1;return _meta&&(has=_meta.findIndex(item=>{return item.name===attrName})!==-1),has},hasAttrEx=(attrName,member)=>{return _this._.instanceOf.findIndex(item=>{return!!item.meta[member]&&hasAttr(attrName,item.meta[member])})!==-1},isDefined=(member,ignoreLast)=>{let result=!1,last=_this._.instanceOf.length,i=1;for(let instance of _this._.instanceOf){if(instance.meta[member]&&i!==last){result=!0;break}i++}return result},isPatternMatched=(pattern,name)=>{let isMatched="*"===pattern;return isMatched||(pattern.indexOf("*")!==-1?(pattern=pattern.replace("*","[\\w]"),pRegEx=new RegExp(patt