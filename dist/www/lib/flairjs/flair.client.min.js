/**
 * @preserve
 * Flair.js
 * True Object Oriented JavaScript
 * 
 * Assembly: flair.client
 *     File: ./flair.client.js
 *  Version: 0.25.53
 *  Sun, 17 Mar 2019 20:42:37 GMT
 * 
 * (c) 2017-2019 Vikas Burman
 * Licensed under MIT
 */
(()=>{"use strict";const e=void 0!==!0?require("flairjs"):"undefined"!=typeof WorkerGlobalScope?WorkerGlobalScope.flair:(!0).flair,{Class:t,Struct:s,Enum:n,Interface:i,Mixin:r}=e,{Aspects:a}=e,{AppDomain:o}=e,l=e.AppDomain.context.current().name,{$$:c,attr:p}=e,{bring:u,Container:f,include:d}=e,{Port:m}=e,{on:b,post:h,telemetry:g}=e,{Reflector:v}=e,{Serializer:$}=e,{Tasks:y}=e,{TaskInfo:A}=e.Tasks,{as:x,is:S,isComplies:j,isDerivedFrom:k,isImplements:O,isInstanceOf:T,isMixed:C}=e,{getAssembly:R,getAttr:w,getContext:z,getResource:D,getRoute:E,getType:I,ns:B,getTypeOf:P,typeOf:L}=e,{dispose:M,using:W}=e,{Args:F,Exception:G,noop:U,nip:V,nim:H,nie:J,event:q}=e,{env:N}=e.options,{forEachAsync:K,replaceAll:Q,splitAndTrim:X,findIndexByProp:Y,findItemByProp:Z,which:_,isArrowFunc:ee,isASyncFunc:te,sieve:se,b64EncodeUnicode:ne,b64DecodeUnicode:ie}=e.utils,{$static:re,$abstract:ae,$virtual:oe,$override:le,$sealed:ce,$private:pe,$privateSet:ue,$protected:fe,$protectedSet:de,$readonly:me,$async:be}=c,{$enumerate:he,$dispose:ge,$post:ve,$on:$e,$timer:ye,$type:Ae,$args:xe,$inject:Se,$resource:je,$asset:ke,$singleton:Oe,$serialize:Te,$deprecate:Ce,$session:Re,$state:we,$conditional:ze,$noserialize:De,$ns:Ee}=c;let Ie=JSON.parse('{"mounts":{"main":"/"},"main-appSettings":[{"name":"strict","value":false},{"name":"click","value":false},{"name":"popstate","value":false},{"name":"dispatch","value":false},{"name":"hashbang","value":false},{"name":"decodeURLComponents","value":true}],"main-middlewares":[]}'),Be=e.Port("settingsReader");if("function"==typeof Be){let e=Be("flair.client");e&&(Ie=Object.assign(Ie,e))}Ie=Object.freeze(Ie),e.AppDomain.context.current().currentAssemblyBeingLoaded("./flair.client{.min}.js"),(async()=>{const{Bootware:e}=B();c("sealed"),c("ns","flair.bw.client"),t("Router",e,function(){let e=null;c("override"),this.construct=(e=>{e("Client Router",!0)}),c("override"),this.boot=(async t=>{e||(e=o.context.current().allRoutes(!0)).sort((e,t)=>e.index<t.index?-1:e.index>t.index?1:0);let s=null,n=!1;for(let i of e)i.mount===t.name&&t.app(i.path,(e,t)=>{const r=e=>{e||t()},a=e=>{o.app().onError(e)};s=new i.Handler;try{"function"==typeof(n=s[i.verb](e)).then?n.then(e=>{r(e)}).catch(a):r(n)}catch(e){a(e)}})})})})(),(async()=>{const{App:e}=B("flair.boot");c("ns","flair.client"),t("App",e,function(){})})(),(async()=>{const e=await d("[Page]","page"),{ClientHost:s}=B("flair.boot");c("sealed"),c("ns","flair.client"),t("Client",s,function(){let t={},s=null;c("override"),this.construct=(e=>{e("Page","1.x")}),this.app=(()=>this.mounts["main"]),this.mounts={get:()=>t,set:U},c("override"),this.boot=(async s=>{s();let n=null,i="",r=null;const a=e=>{let t={},s=Ie[`${e}-appSettings`];if(s&&s.length>0)for(let e of s)t[e.name]=e.value;return t};n=a("main");let o=e.create(n);o.strict(n.strict),o.base("/");for(let s of Object.keys(Ie.mounts))"main"===s?(i="/",r=o):(n=a(s),i=Ie.mounts[s],(r=e.create(n)).strict(n.strict),r.base(i)),t[s]=Object.freeze({name:s,root:i,app:r});t=Object.freeze(t)}),c("override"),this.start=(async e=>{e(),s=(()=>{let e=N.global.location.hash;"#!/"===e.substr(0,3)&&(e=e.substr(3)),"#!"===e.substr(0,2)&&(e=e.substr(2)),"#/"===e.substr(0,2)&&(e=e.substr(2)),"#"===e.substr(0,1)&&(e=e.substr(1));let t=null;for(let s of this.mounts)if(e.startsWith(s.root)){t=s.app,e=e.substr(s.root.length);break}t||(t=this.mounts["main"]),setTimeout(()=>{t(e)},0)})}),c("override"),this.stop=(async e=>{e(),N.global.removeEventListener("hashchange",s)}),c("override"),this.ready=(async e=>{e(),N.global.addEventListener("hashchange",s),console.log(`${o.app().info.name}, v${o.app().info.version}`)}),c("override"),this.dispose=(e=>{e(),t=null})})})(),(async()=>{const{App:e}=B("flair.boot");c("ns","flair.client"),t("WorkerApp",e,function(){})})(),e.AppDomain.context.current().currentAssemblyBeingLoaded(""),e.AppDomain.registerAdo('{"name":"flair.client","file":"./flair.client{.min}.js","desc":"True Object Oriented JavaScript","title":"Flair.js","version":"0.25.53","lupdate":"Sun, 17 Mar 2019 20:42:37 GMT","builder":{"name":"<<name>>","version":"<<version>>","format":"fasm","formatVersion":"1","contains":["initializer","types","enclosureVars","enclosedTypes","resources","assets","routes","selfreg"]},"copyright":"(c) 2017-2019 Vikas Burman","license":"MIT","types":["flair.bw.client.Router","flair.client.App","flair.client.Client","flair.client.WorkerApp"],"resources":[],"assets":[],"routes":[]}')})();
//# sourceMappingURL=./flair.client.min.js.map